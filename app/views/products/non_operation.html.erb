<% if roles.include?(InventoryManagementSystem::PRODUCT_NON_OPERATION_PARENT_FOLDER) %>
  <%= link_parent_folder(parent_product_categories_path(:category_type => ProductCategory::NON_OPERATION)) %>
<% else %>
  <%= not_link_parent_folder %>
<% end %>


<% if @listing_categories.present? %>

  <% unless @listing_categories.icon == ProductCategory::ICON_FILE %>
      <% if roles.include?(InventoryManagementSystem::PRODUCT_NON_OPERATION_SUB_FOLDER) %>
        <%= link_subfolder(new_product_category_path(:category_type => ProductCategory::NON_OPERATION, :parent_id => @listing_categories.id)) %>
      <% else %>
        <%= not_link_subfolder %>
      <% end %>
  <% else %>
    <%= not_link_subfolder %>
  <% end %>

  <% unless @listing_categories.icon == ProductCategory::ICON_FILE %>
      <% if roles.include?(InventoryManagementSystem::PRODUCT_NON_OPERATION_EDIT_SUB_FOLDER) %>
        <%= link_edit_subfolder(edit_product_category_path(@listing_categories)) %>
      <% else %>
        <%= not_link_edit_subfolder %>
      <% end %>
  <% else %>
    <%= not_link_edit_subfolder %>
  <% end %>

  <% unless @listing_categories.icon == ProductCategory::ICON_FILE %>
      <% if @listing_categories.children.present? %>
            <% if @listing_categories.children.first.icon.present? %>
                  <% unless @listing_categories.children.first.icon == ProductCategory::ICON_FOLDER %>
                      <% if roles.include?(InventoryManagementSystem::PRODUCT_NON_OPERATION_ADD_NEW_FILE) %>
                        <%= render "/products/add_file", :listing_categories => @listing_categories %>
                      <% else %>
                        <%= not_link_addfile_button %>
                      <% end %>
                  <% else %>
                    <%= not_link_addfile_button %>
                  <% end %>
            <% else %>
              <%= not_link_addfile_button %>
            <% end %>
      <% else %>
        <%= render "/products/add_file", :listing_categories => @listing_categories %>
      <% end %>
  <% else %>
    <%= not_link_addfile_button %>
  <% end %>
  
  <% if @listing_categories.product.present? %>
      <% if roles.include?(InventoryManagementSystem::PRODUCT_NON_OPERATION_EDIT_FILE) %>
        <%= link_document_edit(edit_product_path(@listing_categories.product)) %>
      <% else %>
        <%= not_link_document_edit %>
      <% end %>
  <% else %>
    <%= not_link_document_edit %>
  <% end %>

<% end %>

<div id="product_layout" class="easyui-layout" style="width:auto;height:500px;">  
    <div region="west" split="true" title="Non Operation Product Categories" style="width:300px;">
      <%= render "/products/category" %>
    </div>  
    <div region="center" title="Non Operation Product Details" style="padding:5px;background:#eee;">
      <div id = "loading_products">
        <%= render "/products/product_details" %>
      </div>
    </div>  
</div> 

<div class="icon_tag">
  <%= link_close_button %>
</div>